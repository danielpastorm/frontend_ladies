<div class="grid" *ngIf="kits.length > 0">
    <div class="col-12 md:col-3" *ngFor="let kit of kits">

        <p-card [header]="kit.nombre" [subheader]="kit.descripcion" class="text-center">

            <!-- Carrusel de imágenes (opcional) -->
            <p-carousel *ngIf="kit.imagenesArray.length > 0" [value]="kit.imagenesArray" [numVisible]="1"
                [circular]="true" [autoplayInterval]="4000">
                <ng-template let-img pTemplate="item">
                    <img [src]="'https://ladies-first.shop/uploads/2/' + 'Captura de pantalla 2024-01-12 215138.png'"
                        alt="imagen" class="w-48 h-48 object-contain border-round mx-auto" />
                </ng-template>
            </p-carousel>


            <!-- Categorías -->
            <div *ngFor="let categoria of kit.categorias" class="mt-3">
                <h5>{{ categoria.nombre }}</h5>
                <ul>
                    <li *ngFor="let producto of categoria.productos">
                        {{ getNombreProductos(producto.id) }} (x{{ producto.cantidad }})
                    </li>
                </ul>
            </div>

            <button pButton label="Seleccionar" class="mt-3" (click)="seleccionarKit(kit)"></button>
        </p-card>
    </div>
</div>


<!-- MODAL -->
<p-dialog header="Personaliza tu kit" [(visible)]="mostrarModal" [modal]="true" [style]="{ width: '35vw' }"
    class="text-center">
    <ng-container *ngIf="kitSeleccionado">
        <div *ngFor="let categoria of kitSeleccionado.categorias" class="mb-4">
            <h5>{{ categoria.nombre }}</h5>

            <!-- <p-dropdown [options]="getOpcionesProductos(categoria)" [(ngModel)]="categoria.idProductoSeleccionado"
                placeholder="Selecciona un producto">
            </p-dropdown> -->

            <div class="flex gap-3 flex-wrap">
                <div *ngFor="let producto of categoria.productos"
                    (click)="categoria.idProductoSeleccionado = producto.id"
                    class="flex flex-column align-items-center cursor-pointer" [ngClass]="{
                    'border-2 border-green-500 p-2 rounded-full': categoria.idProductoSeleccionado === producto.id,
                    'opacity-100': categoria.idProductoSeleccionado === producto.id,
                    'opacity-60': categoria.idProductoSeleccionado !== producto.id
                  }">

                    <img
  [src]="'https://ladies-first.shop/uploads/2/Captura%20de%20pantalla%202024-01-12%20215138.png'"
  alt="{{ getNombreProducto(producto.id) }}"
  style="width: 60px; height: 60px; object-fit: cover; border-radius: 50%; border: 2px solid pink; background: white;" />

                    <small class="mt-2">{{ getNombreProducto(producto.id) }}</small>
                </div>
            </div>

        </div>



        <h5>Productos extras</h5>
        <div class="flex flex-wrap gap-2">
            <div *ngFor="let prod of productosCatalogo" class="p-2 border-round border-1 surface-border"
                style="cursor: pointer" (click)="agregarExtra(prod.id)">
                <img [src]="getImagenProducto(prod.id)" alt="extra" width="50" class="mr-2 rounded-full" />
                {{ prod.nombre }}

                <button *ngIf="productosExtras.includes(prod.id)" icon="pi pi-times"
                    class="p-button-sm p-button-danger ml-2" (click)="quitarExtra(prod.id); $event.stopPropagation()">
                    Quitar
                </button>
            </div>
        </div>

        <button pButton label="Confirmar selección" class="mt-4" (click)="confirmarSeleccion()"></button>
    </ng-container>
</p-dialog>